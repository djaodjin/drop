<?xml version="1.0" ?>
<projects>
  <project name="comm">
    <title>configuration files for mail server</title>
    <description>
maintenance scripts for authentication and communication services
    </description>
    <maintainer>
      <personname>Sebastien Mirolo</personname>
      <email>smirolo@djaodjin.com</email>
    </maintainer>
    <package name="RedHat">
      <variable name="domainName">
        <description>Domain name for the machine being configured.</description>
      </variable>
      <variable name="notifyEmail">
        <description>Email to send notification to about the state of the machine.</description>
      </variable>
      <variable name="emailHost">
        <description>Host for the email server used to send notification about the state of the machine.</description>
      </variable>
      <variable name="emailPort">
        <description>Port on the host email server used to send notification about the state of the machine.</description>
      </variable>
      <variable name="emailHostUser">
        <description>User to connect to the email server used to send notification about the state of the machine.</description>
      </variable>
      <variable name="emailHostPassword">
        <description>Password to connect to the email server used to send notification about the state of the machine.</description>
      </variable>
      <!-- Access control -->
      <dep name="iptables">
        <bin>iptables</bin>
        <port>22</port>
        <!-- mail receiving and sending -->
        <port>25</port>
        <port>587</port>
        <port>993</port>
        <port>995</port>
        <!-- To get TLS certificates -->
        <port>80</port>
        <port>443</port>
      </dep>
      <dep name="authconfig">
        <bin>authconfig</bin>
      </dep>
      <dep name="sssd">
        <bin>sssd</bin>
      </dep>
      <!-- to get TLS certificates -->
      <dep name="certbot">
        <bin>certbot</bin>
      </dep>
      <dep name="nginx">
        <bin>nginx</bin>
      </dep>

      <dep name="opendkim">
        <bin>opendkim</bin>
      </dep>
      <dep name="openldap-servers">
        <bin>slapd</bin>
      </dep>
      <!-- monitoring -->
      <dep name="fail2ban">
        <bin>fail2ban-client</bin>
      </dep>
      <dep name="syslog-ng">
        <bin>syslog-ng</bin>
      </dep>
      <dep name="syslog-ng-libdbi">
        <lib>dbi</lib>
      </dep>
      <dep name="monit">
        <bin>monit</bin>
      </dep>
      <!-- mail -->
      <dep name="clamav">
        <bin>clamscan</bin>
      </dep>
      <dep name="spamassassin">
        <bin>spamc</bin>
        <extra name="/etc/default/lire.d/spamassassin.cfg">
# generated by dservices.
service=spamassassin
daemon=/usr/sbin/spamd
rotateperiod=weekly
logfile=/var/log/mail.log.1
filter="grep spamd: -"
        </extra>
      </dep>
      <!-- mail services -->
      <dep name="postfix">
        <bin>postfix</bin>
        <!-- use ssl keys to authenticate server. These are defined as "extra"s
             because we donot want their absence to trigger an installation
             of postfix. -->
        <extra name="/etc/ssl/private/%(domainName)s.key"></extra>
        <extra name="/etc/ssl/certs/%(domainName)s.pem"></extra>
        <extra name="/etc/postfix/main.cf">
          <recipient_delimiter>+</recipient_delimiter>
          <unknown_local_recipient_reject_code>550</unknown_local_recipient_reject_code>
        </extra>
        <!-- for spamassassin -->
        <extra name="/etc/postfix/master.cf">
          <smtp>     inet  n       -       n       -       -       smtpd -o content_filter=spamassassin</smtp>
          <submission>     inet  n       -       n       -       -       smtpd -o content_filter=spamassassin</submission>
          <spamassassin> unix -     n       n       -       -       pipe user=spamassassin argv=/usr/bin/spamc -e /usr/sbin/sendmail -oi -f ${sender} ${recipient}</spamassassin>
          <!-- http://www.linux.com/learn/tutorials/313660:using-clamav-to-kill-viruses-on-postfix -->
          <scan>unix - - n - 16 smtp -o smtp_send_xforward_command=yes</scan>
        </extra>
      </dep>
      <dep name="openldap-clients">
        <bin>ldapsearch</bin>
      </dep>
      <dep name="dovecot" >
        <bin>dovecot</bin>
      </dep>
      <dep name="cyrus-sasl">
        <etc>sysconfig/saslauthd</etc>
      </dep>
    </package>
  </project>
  <project name="openldap-clients-with-openssl">
    <package name="Fedora">
      <fetch>
        <url>https://djaodjin.com/pub/fedora/linux/updates/fc25/x86_64/openldap-2.4.44-10.fc25.x86_64.rpm</url>
        <sha1>6f6428deee881efa18003482d5353587fbf35b5b</sha1>
      </fetch>
      <fetch>
        <url>https://djaodjin.com/pub/fedora/linux/updates/fc25/x86_64/openldap-clients-2.4.44-10.fc25.x86_64.rpm</url>
        <sha1>dbcfa8f4ceda5b31c17bcab5484f2de7c3aec8ff</sha1>
      </fetch>
    </package>
  </project>
</projects>
